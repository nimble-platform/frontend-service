<call-status [callStatus]="initCallStatus"></call-status>

<ng-container *ngIf="isReady()">
    <div class="row title-row">
        <div class="col-6"><h4>Order Details</h4></div>
        <div class="col-6"><h4>Delivery Details</h4></div>
    </div>

    <div class="row content-row">
        <div class="col-6">
            <text-input presentationMode="view" label="Warranty" 
                [text]="getWarrantyPeriodText()" labelClass="col-4" valueClass="col-8">
            </text-input>
        </div>
        <div class="col-6">
            <text-input presentationMode="view" label="Delivery Period" 
                [text]="getDeliveryPeriodText()" labelClass="col-4" valueClass="col-8">
            </text-input>
        </div>
    </div>

    <div class="row content-row">
        <div class="col-6">
            <text-input presentationMode="view" label="Incoterms" 
                [text]="getIncoterm()" labelClass="col-4" valueClass="col-8">
            </text-input>
        </div>
        <div class="col-6">
            <text-input presentationMode="view" label="Street" 
                [text]="address.streetName" labelClass="col-4" valueClass="col-8">
            </text-input>
        </div>
    </div>

    <div class="row content-row">
        <div class="col-6">
            <text-input presentationMode="view" label="Quantity"
                [text]="getQuantityText()" labelClass="col-4" valueClass="col-8">
            </text-input>
        </div>
        <div class="col-6">
            <text-input presentationMode="view" label="Building Number" 
                [text]="address.buildingNumber" labelClass="col-4" valueClass="col-8">
            </text-input>
        </div>
    </div>

    <div class="row content-row">
        <div class="col-6">
            <text-input presentationMode="view" label="Total Price"
                [text]="getTotalPriceText()" labelClass="col-4" valueClass="col-8">
            </text-input>
        </div>
        <div class="col-6">
            <text-input presentationMode="view" label="City" 
                [text]="address.cityName" labelClass="col-4" valueClass="col-8">
            </text-input>
        </div>
    </div>

    <div class="row content-row">
        <div class="col-6">
            <div class="row">
                <div class="col-4">
                    <strong>Data Monitoring Service:</strong>
                </div>
                <div class="col-8">
                    <span *ngIf="!fetchDataMonitoringStatus.isDisplayed()">{{ dataMonitoringDemanded ? "Yes" : "No" }}</span>
                    <call-status [callStatus]="fetchDataMonitoringStatus"></call-status>
                </div>
            </div>
        </div>
        <div class="col-6">
            <text-input presentationMode="view" label="Postal Code" 
                [text]="address.postalZone" labelClass="col-4" valueClass="col-8">
            </text-input>
        </div>
    </div>

    <div class="row content-row">
        <div class="col-6">
            <text-input presentationMode="view" label="Payment Means" 
                [text]="getPaymentMeans()" labelClass="col-4" valueClass="col-8">
            </text-input>
        </div>
        <div class="col-6">
            <text-input presentationMode="view" label="Country" 
                [text]="address.country.name" labelClass="col-4" valueClass="col-8">
            </text-input>
        </div>
    </div>

    <div class="row content-row">
        <div class="col-6">
            <text-input presentationMode="view" label="Payment Terms" 
                [text]="paymentTermsWrapper.paymentTerm" labelClass="col-4" valueClass="col-8">
            </text-input>
        </div>
        <div class="col-6">
            <!-- Nothing for now -->
        </div>
    </div>

</ng-container>

<hr>

<div class="row content-row" *ngIf="isReady()">
    <div class="col-6">
        <text-input presentationMode="edit" [disabled]="isReadOnly() || userRole === 'seller'"
            label="Customer's Note" [(text)]="order.note" labelClass="col-4" valueClass="col-8">
        </text-input>
    </div>
    <div class="col-6">
        <text-input presentationMode="edit" *ngIf="orderResponse" [disabled]="isReadOnly()"
            label="Supplier's Note" [(text)]="orderResponse.note" labelClass="col-4" valueClass="col-8">
        </text-input>
    </div>
</div>

<hr>

<!-- Contract Preview -->
<div class="row" *ngIf="isReady()">
    <div class="col-12">
        <h2>
            Terms and Conditions
            <button class="btn btn-outline-dark" (click)="onPreviewTermsAndConditions()"
                [disabled]="!order.contract || order.contract[0]?.clause.length === 0">
                <i class="fas fa-chevron-up fa-fw fa-lg mt-2" aria-hidden="true" *ngIf="showPreview"></i>
                <i class="fas fa-chevron-down fa-fw fa-lg mt-2" aria-hidden="true" *ngIf="!showPreview"></i>
            </button>
        </h2>
    </div>
    <call-status [callStatus]="fetchTermsAndConditionsStatus"></call-status>
    <div class="col-12" *ngIf="showPreview && termsAndConditions">
        <h4>General terms and conditions</h4>
        <textarea rows="12" class="form-control" [disabled]="true">{{ termsAndConditions }}</textarea>
        <contract [contract]="order.contract[0]">
        </contract>
    </div>
</div>

<hr>

<!-- Actions -->
<ng-container *ngIf="userRole === 'buyer' && isReady()">
    <div class="row actions-row" *ngIf="!isReadOnly()">
        <div class="col-8 call-status-col"><call-status [callStatus]="submitCallStatus"></call-status></div>
        <div class="col-2">
            <button class="btn btn-secondary action" [disabled]="isLoading()" (click)="onBack()">
                Back
            </button>
        </div>
        <div class="col-2">
            <button class="btn btn-primary action" [disabled]="isLoading()" (click)="onOrder()">
                Order
            </button>
        </div>
    </div>

    <div class="row actions-row" *ngIf="isReadOnly() && !isOrderCompleted()">
        <div class="col-10 call-status-col"><call-status [callStatus]="submitCallStatus"></call-status></div>
        <div class="col-2">
            <button class="btn btn-secondary action" [disabled]="isLoading()" (click)="onBack()">
                Back
            </button>
        </div>
    </div>

    <div class="row actions-row" *ngIf="isReadOnly() && isOrderCompleted()">
        <div class="col-7 call-status-col"><call-status [callStatus]="submitCallStatus"></call-status></div>
        <div class="col-2">
            <button class="btn btn-secondary action" [disabled]="isLoading()" (click)="onBack()">
                Back
            </button>
        </div>
        <div class="col-3">
            <button class="btn btn-primary action" [disabled]="isLoading() || isOrderRejected()" (click)="onDownloadContact()">
                Download Contract
            </button>
        </div>
    </div>
</ng-container>

<ng-container *ngIf="userRole === 'seller' && isReady()">
    <div class="row actions-row" *ngIf="!isOrderCompleted()">
        <div class="col-6 call-status-col"><call-status [callStatus]="submitCallStatus"></call-status></div>
        <div class="col-2">
            <button class="btn btn-secondary action" [disabled]="isLoading()" (click)="onBack()">
                Back
            </button>
        </div>
        <div class="col-2">
            <button class="btn btn-secondary action" [disabled]="isLoading()" (click)="onRespondToOrder(false)">
                Reject
            </button>
        </div>
        <div class="col-2">
            <button class="btn btn-primary action" [disabled]="isLoading()" (click)="onRespondToOrder(true)">
                Accept
            </button>
        </div>
    </div>
    
    <div class="row actions-row" *ngIf="isOrderCompleted()">
        <div class="col-3 call-status-col"><call-status [callStatus]="submitCallStatus"></call-status></div>
        <div class="col-2">
            <button class="btn btn-secondary action" [disabled]="isLoading()" (click)="onBack()">
                Back
            </button>
        </div>
        <div class="col-2">
            <button class="btn btn-secondary action" [disabled]="isLoading() || isOrderRejected()" (click)="onDownloadContact()">
                Download Contract
            </button>
        </div>
        <div class="col-3">
            <button class="btn btn-primary action" [disabled]="isLoading() || isOrderRejected()" (click)="onSearchTransportService()">
                Search for Transport Service Provider
            </button>
        </div>
        <div class="col-2">
            <button class="btn btn-primary action" [disabled]="isLoading() || isOrderRejected()" (click)="onDispatchOrder()">
                Dispatch Order
            </button>
        </div>
    </div>
</ng-container>